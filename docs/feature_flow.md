# SkillTrace 機能フロー

## 1. ユーザー登録・ログイン

### ユーザー登録フロー

1. ユーザーが登録ページにアクセス
2. 名前、メールアドレス、パスワードを入力
3. 登録ボタンをクリック
4. バリデーションチェック
5. ユーザー情報をデータベースに保存
6. ログイン状態でホーム画面にリダイレクト

### ログインフロー

1. ユーザーがログインページにアクセス
2. メールアドレス、パスワードを入力
3. ログインボタンをクリック
4. 認証処理
5. 認証成功時、ホーム画面にリダイレクト
6. 認証失敗時、エラーメッセージを表示

## 2. プロフィール管理

### プロフィール編集フロー

1. ユーザーがプロフィール編集ページにアクセス
2. 現在のプロフィール情報を表示
3. 名前、年齢、地域などの情報を編集
4. プロフィール画像をアップロード
5. 保存ボタンをクリック
6. バリデーションチェック
7. プロフィール情報をデータベースに保存
8. プロフィールページにリダイレクト

## 3. スキル管理

### スキル追加フロー

1. ユーザーがスキル追加ページにアクセス
2. プログラミング言語を選択
3. 追加ボタンをクリック
4. ユーザーと言語の関連をデータベースに保存
5. ホーム画面にリダイレクト

### スキルレベル設定フロー

1. ユーザーがスキル詳細ページにアクセス
2. 星評価の編集ボタンをクリック
3. 星の数（1〜5）を選択
4. 保存ボタンをクリック
5. スキルレベルをデータベースに保存
6. スキル詳細ページにリダイレクト

### スキル能力追加フロー

1. ユーザーがスキル詳細ページにアクセス
2. 「できること」の追加ボタンをクリック
3. 能力内容を入力
4. 保存ボタンをクリック
5. スキル能力をデータベースに保存
6. スキル詳細ページにリダイレクト

### スキル履歴追加フロー

1. ユーザーがスキル詳細ページにアクセス
2. 「軌跡」の追加ボタンをクリック
3. カテゴリを選択
4. 履歴内容を入力
5. 画像をアップロード（任意）
6. 保存ボタンをクリック
7. スキル履歴をデータベースに保存
8. スキル詳細ページにリダイレクト

## 4. ソーシャル機能

### フォローフロー

1. ユーザーが他のユーザーのプロフィールページにアクセス
2. フォローボタンをクリック
3. フォロー関係をデータベースに保存（非同期処理）
4. フォローボタンの表示を「フォロー中」に変更

### フォロー解除フロー

1. ユーザーが他のユーザーのプロフィールページにアクセス
2. 「フォロー中」ボタンをクリック
3. フォロー関係をデータベースから削除（非同期処理）
4. ボタンの表示を「フォロー」に変更

### メッセージ送信フロー

1. ユーザーがメッセージページにアクセス
2. メッセージを送りたいユーザーを選択
3. メッセージを入力
4. 送信ボタンをクリック
5. メッセージをデータベースに保存
6. メッセージ詳細ページにリダイレクト

## 5. 検索機能

### ユーザー検索フロー

1. ユーザーが検索ページにアクセス
2. 検索キーワードを入力
3. 検索ボタンをクリック
4. キーワードに一致するユーザーをデータベースから検索
5. 検索結果を表示

## 6. 主要画面遷移図

```
+----------------+     +----------------+     +----------------+
|                |     |                |     |                |
|  ログイン画面   |---->|  ホーム画面    |---->| プロフィール画面 |
|                |     |                |     |                |
+----------------+     +----------------+     +----------------+
                              |
                              |
                              v
+----------------+     +----------------+     +----------------+
|                |     |                |     |                |
|  検索画面       |<--->|  スキル詳細画面  |<--->|  スキル編集画面  |
|                |     |                |     |                |
+----------------+     +----------------+     +----------------+
                              |
                              |
                              v
+----------------+     +----------------+
|                |     |                |
| フォロー/フォロワー |<--->|  メッセージ画面  |
|                |     |                |
+----------------+     +----------------+
```

## 7. 主要処理シーケンス

### スキル詳細表示シーケンス

```
ユーザー -> ブラウザ: スキル詳細ページにアクセス
ブラウザ -> Controller: GET /users/{userId}/skills/{skillId}
Controller -> UserAuthService: getLoginUserId()
UserAuthService -> Controller: ログインユーザーID
Controller -> UserLanguageRepository: findByUserIdAndLanguageId(userId, skillId)
UserLanguageRepository -> Controller: スキル情報
Controller -> UserRepository: findById(userId)
UserRepository -> Controller: ユーザー情報
Controller -> TraceRepository: getByUserLanguageId(userLanguageId)
TraceRepository -> Controller: スキル履歴情報
Controller -> AbilityRepository: getByUserLanguageId(userLanguageId)
AbilityRepository -> Controller: スキル能力情報
Controller -> ブラウザ: スキル詳細ビュー
ブラウザ -> ユーザー: スキル詳細ページを表示
```

### スキル履歴追加シーケンス

```
ユーザー -> ブラウザ: スキル履歴追加フォーム送信
ブラウザ -> Controller: POST /users/{userLanguageId}/traces
Controller -> Request: バリデーション
Request -> Controller: バリデーション結果
Controller -> Storage: 画像アップロード
Storage -> Controller: 画像URL
Controller -> Trace: 新規インスタンス作成
Controller -> Trace: 属性設定
Controller -> Trace: save()
Trace -> Database: INSERT
Database -> Trace: 保存結果
Trace -> Controller: 保存結果
Controller -> UserLanguageRepository: findById(userLanguageId)
UserLanguageRepository -> Controller: スキル情報
Controller -> ブラウザ: リダイレクト
ブラウザ -> ユーザー: スキル詳細ページを表示
```
